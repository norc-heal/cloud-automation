location /viewer/ {
    if ($csrf_check !~ ^ok-\S.+$) {
      return 403 "failed csrf check";
    }

    set $proxy_service  "viewer";
    set $upstream http://127.0.0.1:8080/lw-workspace/proxy/;
    rewrite ^/viewer/(.*) /$1 break;
    proxy_pass $upstream;
}
